suite: Init template
release:
  name: forgejo-unittests
  namespace: testing
templates:
  - init.yaml
tests:
  - it: runs gpg in batch mode
    set:
      signing.privateKey: |-
        -----BEGIN PGP PRIVATE KEY BLOCK-----
        {placeholder}
        -----END PGP PRIVATE KEY BLOCK-----
    asserts:
      - equal:
          path: stringData["configure_gpg_environment.sh"]
          value: |-
            #!/usr/bin/env bash
            set -eu

            gpg --batch --import /raw/private.asc
